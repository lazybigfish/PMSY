# 移除 Supabase 依赖 - 任务 1.4 角色权限表补充记录

## 发现的问题

用户询问后发现漏掉了 `app_roles` 和 `role_permissions` 表的初始化数据。

## 补充内容

### 1. 创建 app_roles 表
- **文件**: `009_create_app_roles.sql`
- **字段**: key (主键), name, description, created_at
- **数据**: 3个默认角色
  - `admin`: 管理员 - 系统超级管理员，拥有所有权限
  - `manager`: 项目经理 - 负责项目管理和团队协作
  - `user`: 普通用户 - 参与项目执行的团队成员

### 2. 创建 role_permissions 表
- **文件**: `009_create_app_roles.sql`
- **字段**: id, role_key, module_key, created_at
- **数据**: 21条权限记录

#### Admin 角色权限（8个模块）
- dashboard, projects, tasks, suppliers
- analysis, water, files, system

#### Manager 角色权限（7个模块）
- dashboard, projects, tasks, suppliers
- analysis, water, files
- （不包括 system 系统设置）

#### User 角色权限（6个模块）
- dashboard, projects, tasks, suppliers
- water, files
- （不包括 analysis 分析和 system 系统设置）

## 完整的初始化数据汇总

| 表名 | 数据条数 | 说明 |
|------|----------|------|
| `ai_roles` | 1条 | 默认AI角色 |
| `milestone_templates` | 7条 | 7个里程碑阶段 |
| `milestone_tasks` | 26条 | 各阶段的任务 |
| `app_roles` | 3条 | 应用角色 |
| `role_permissions` | 21条 | 角色权限 |
| **其他表** | 0条 | 无初始化数据 |

**总计：58条初始化数据**

## 数据库表总数

现在共有 **31张表**：

1. profiles
2. projects
3. project_members
4. project_modules
5. milestone_templates
6. project_milestones
7. milestone_tasks
8. tasks
9. task_assignees
10. task_progress_updates
11. task_comments
12. suppliers
13. supplier_payment_plans
14. supplier_acceptance_records
15. risks
16. folders
17. files
18. file_operation_logs
19. notifications
20. storage_quotas
21. reports
22. report_templates
23. ai_providers
24. ai_roles
25. ai_analysis_results
26. forum_posts
27. forum_comments
28. forum_likes
29. hot_news
30. **app_roles** (新增)
31. **role_permissions** (新增)

## 结论

所有初始化数据已完整，包括：
- ✅ AI 角色
- ✅ 里程碑模板和任务
- ✅ 应用角色和权限
- ✅ 默认管理员（通过 seed 脚本）
