# 任务状态更新报错修复记录

## 问题描述
任务详情页，直接调整任务状态为已完成，显示报错"状态更新失败"，但实际上是调整为了已完成。

## 问题原因
在 `taskService.updateTask` 函数中，构建更新数据时，将所有字段（包括未传入的字段）都放入了 `updateData` 对象中。这导致未传入的字段值为 `undefined`，发送给后端时可能导致后端处理异常。

**原代码问题**：
```typescript
const updateData: any = {
  title: data.title,           // 如果只更新状态，这些字段为 undefined
  description: data.description,
  status: data.status,
  priority: data.priority,
  start_date: data.start_date,
  due_date: data.due_date,
};
```

当只更新 `status` 和 `completed_at` 时，`title`、`description`、`priority` 等字段会被设置为 `undefined`，这可能导致后端报错。

## 修复方案
修改 `updateTask` 函数，只包含实际传入的字段：

```typescript
const updateData: any = {};

// 只包含传入的字段，避免发送 undefined 值
if (data.title !== undefined) {
  updateData.title = data.title;
}
if (data.description !== undefined) {
  updateData.description = data.description;
}
if (data.status !== undefined) {
  updateData.status = data.status;
}
// ... 其他字段同理
```

## 修改文件
- `src/services/taskService.ts` - 修改 `updateTask` 函数

## 测试验证
- [x] 只更新任务状态为已完成时，不报错
- [x] 更新其他单个字段时，不报错
- [x] 更新多个字段时，正常工作

## 重启服务
前端服务已重启，更改已生效。
