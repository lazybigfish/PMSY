# PMSY系统模块划分与拆解方案

## 一、模块划分说明

基于对原始需求文档的全面分析，按照**功能关联性、业务逻辑独立性、开发实施便利性**三大原则，将PMSY项目管理系统划分为以下8个独立模块：

### 划分依据

1. **业务领域边界清晰**：每个模块对应明确的业务领域（如认证、项目管理、任务管理等）
2. **数据实体独立**：各模块拥有独立的核心数据实体，减少跨模块数据耦合
3. **用户角色职责分离**：不同角色（项目用户、系统管理员）使用不同模块组合
4. **功能内聚性高**：模块内部功能紧密相关，模块间通过标准接口交互
5. **技术实现独立**：各模块可独立开发、测试、部署

### 模块间关系图

```
┌─────────────────────────────────────────────────────────────┐
│                      认证与公共模块                           │
│                   (用户认证、全局导航)                         │
└─────────────────────┬───────────────────────────────────────┘
                      │ 提供用户身份
                      ▼
┌─────────────────────────────────────────────────────────────┐
│  工作台模块  │  项目管理模块  │  任务中心模块  │  供应商模块   │
│  (首页概览)  │  (核心功能)   │  (任务协作)   │  (外部协作)   │
└──────┬───────┴───────┬───────┴───────┬───────┴───────┬───────┘
       │               │               │               │
       │               │ 依赖项目数据   │ 依赖项目数据   │
       │               │               │               │
       ▼               ▼               ▼               ▼
┌─────────────────────────────────────────────────────────────┐
│                    数据分析模块                              │
│         (基于项目、任务、供应商数据进行分析)                   │
└─────────────────────┬───────────────────────────────────────┘
                      │ 依赖分析结果
                      ▼
┌─────────────────────────────────────────────────────────────┐
│  周日报模块  │              系统管理模块                       │
│  (报告生成)  │         (用户、配置、模板管理)                  │
└──────────────┴───────────────────────────────────────────────┘
```

---

## 二、模块清单

| 序号 | 模块名称 | 核心定位 | 主要用户 | 优先级 |
|------|----------|----------|----------|--------|
| 1 | 认证与公共模块 | 系统入口、用户认证 | 所有用户 | P0 |
| 2 | 工作台模块 | 项目概览、快捷入口 | 所有用户 | P0 |
| 3 | 项目管理模块 | 项目全生命周期管理 | 项目经理、团队成员 | P0 |
| 4 | 任务中心模块 | 任务分配与协作 | 项目经理、团队成员 | P0 |
| 5 | 供应商管理模块 | 外部供应商协作 | 项目经理、团队成员 | P1 |
| 6 | 数据分析模块 | 项目数据可视化分析 | 项目经理、系统管理员 | P1 |
| 7 | 周日报管理模块 | 报告生成与AI增强 | 项目经理、团队成员 | P1 |
| 8 | 系统管理模块 | 系统配置与基础数据 | 系统管理员 | P1 |

---

## 三、各模块详细说明

### 模块1：认证与公共模块
**模块概述**：提供系统统一入口，处理用户身份认证和全局导航

**核心功能需求**：
- 用户登录（邮箱/密码）
- 身份验证与Token管理
- 全局顶部导航栏
- 用户下拉菜单（个人信息、退出登录）
- 路由权限控制

**非功能需求**：
- 登录响应时间 < 2秒
- 支持JWT Token刷新机制
- 密码加密存储（bcrypt）

**数据结构**：
- users表（id, email, password_hash, role, created_at）

**接口定义**：
- POST /api/auth/login - 用户登录
- POST /api/auth/logout - 用户登出
- GET /api/auth/me - 获取当前用户信息

**依赖关系**：无（基础模块）

---

### 模块2：工作台模块
**模块概述**：系统首页，提供项目概览统计和快捷操作入口

**核心功能需求**：
- 项目统计数据展示（总数、进行中、已完成）
- 快捷入口（新建项目、查看任务、管理供应商）
- 最近访问项目列表
- 待办任务提醒

**非功能需求**：
- 页面加载时间 < 3秒
- 统计数据实时计算

**数据结构**：
- 依赖projects表、tasks表

**接口定义**：
- GET /api/dashboard/stats - 获取统计数据
- GET /api/dashboard/recent - 获取最近项目

**依赖关系**：依赖认证模块、项目管理模块、任务中心模块

---

### 模块3：项目管理模块
**模块概述**：系统核心模块，管理项目全生命周期，包含功能模块、里程碑、风险、周日报子模块

**核心功能需求**：
- 项目CRUD操作
- 项目公开性设置
- 功能模块管理（树形结构，支持Excel导入导出）
- 里程碑管理（7个标准阶段，任务跟踪）
- 风险管理（登记、跟踪、处置记录）
- 周日报管理（报告生成、AI分析）
- 团队成员管理

**非功能需求**：
- 支持最多10级功能模块嵌套
- Excel导入支持最大1000行数据
- 里程碑任务状态实时同步

**数据结构**：
- projects表（核心）
- project_modules表（功能模块）
- project_milestones表（里程碑）
- milestone_tasks表（里程碑任务）
- risks表（风险）
- project_members表（团队成员）
- reports表（周日报）

**接口定义**：
- CRUD /api/projects - 项目管理
- CRUD /api/projects/{id}/modules - 功能模块
- POST /api/projects/{id}/modules/import - Excel导入
- GET /api/projects/{id}/modules/export - Excel导出
- CRUD /api/projects/{id}/milestones - 里程碑
- CRUD /api/projects/{id}/risks - 风险管理
- CRUD /api/projects/{id}/reports - 周日报

**依赖关系**：依赖认证模块、系统管理模块（里程碑模板）

**子模块划分**：
1. 项目基础管理（创建、编辑、删除、列表）
2. 功能模块管理（树形结构、Excel导入导出）
3. 里程碑管理（7阶段任务跟踪）
4. 风险管理（风险登记与处置）
5. 周日报管理（报告生成与导出）

---

### 模块4：任务中心模块
**模块概述**：项目任务分配与协作中心，支持多处理人和公开性设置

**核心功能需求**：
- 任务CRUD操作
- 任务公开性设置
- 多处理人分配
- 任务状态管理（未开始、进行中、暂停、取消、完成）
- 批量状态变更
- 任务时间线展示

**非功能需求**：
- 支持单个任务最多10个处理人
- 批量操作支持最多100个任务
- 任务状态变更实时通知

**数据结构**：
- tasks表（核心）
- task_assignees表（多处理人）

**接口定义**：
- CRUD /api/tasks - 任务管理
- POST /api/tasks/batch-update - 批量状态更新
- POST /api/tasks/{id}/progress - 更新进度

**依赖关系**：依赖认证模块、项目管理模块

---

### 模块5：供应商管理模块
**模块概述**：外部供应商生命周期管理，包含入库、进度跟踪、付款管理

**核心功能需求**：
- 供应商CRUD操作
- 供应商与项目关联
- 建设进度跟踪
- 验收管理
- 付款管理

**非功能需求**：
- 供应商数据与项目可见性一致

**数据结构**：
- suppliers表（核心）
- project_suppliers表（项目供应商关联）

**接口定义**：
- CRUD /api/suppliers - 供应商管理
- CRUD /api/projects/{id}/suppliers - 项目供应商

**依赖关系**：依赖认证模块、项目管理模块

---

### 模块6：数据分析模块
**模块概述**：基于项目、任务、供应商数据进行多维度可视化分析

**核心功能需求**：
- 分析仪表板（风险指标、进度统计、预算执行）
- 甘特图视图（项目时间线、任务依赖）
- 日程表视图（日历形式展示任务和里程碑）
- 风险分析（自动计算风险等级）

**非功能需求**：
- 图表渲染时间 < 5秒
- 支持数据导出（PNG、PDF）
- 数据缓存15分钟

**数据结构**：
- project_analytics表（分析数据）

**接口定义**：
- GET /api/analytics/dashboard - 仪表板数据
- GET /api/analytics/gantt - 甘特图数据
- GET /api/analytics/calendar - 日程表数据
- GET /api/analytics/risks - 风险分析数据

**依赖关系**：依赖认证模块、项目管理模块、任务中心模块、供应商模块

---

### 模块7：周日报管理模块
**模块概述**：项目报告生成与管理，支持AI分析增强

**核心功能需求**：
- 报告模板配置
- 报告自动生成（基于项目数据）
- 富文本编辑
- AI分析增强
- 报告导出（PDF、Word）

**非功能需求**：
- 遵循公文格式标准
- AI分析响应时间 < 10秒
- 支持历史版本对比

**数据结构**：
- reports表（核心）
- report_templates表（报告模板）
- ai_analysis_results表（AI分析结果）

**接口定义**：
- CRUD /api/reports - 报告管理
- POST /api/reports/{id}/generate - 自动生成报告
- POST /api/reports/{id}/ai-analyze - AI分析
- GET /api/reports/{id}/export - 导出报告

**依赖关系**：依赖认证模块、项目管理模块、AI配置模块

---

### 模块8：系统管理模块
**模块概述**：系统基础配置和管理，仅系统管理员可访问

**核心功能需求**：
- 用户管理（创建、删除、重置密码）
- 角色权限管理
- 系统配置项管理
- 里程碑模板管理
- AI配置管理（提供商、角色预设）
- 报告模板配置

**非功能需求**：
- 敏感操作需二次确认
- 配置变更记录审计日志

**数据结构**：
- profiles表（用户详情）
- milestone_templates表（里程碑模板）
- ai_providers表（AI提供商）
- ai_roles表（AI角色）

**接口定义**：
- CRUD /api/admin/users - 用户管理
- CRUD /api/admin/roles - 角色管理
- CRUD /api/admin/config - 配置管理
- CRUD /api/admin/milestone-templates - 里程碑模板
- CRUD /api/admin/ai-config - AI配置
- CRUD /api/admin/report-templates - 报告模板

**依赖关系**：依赖认证模块

---

## 四、模块间数据流转关系

### 数据流向图

```
┌────────────────────────────────────────────────────────────────┐
│                        数据流向说明                             │
└────────────────────────────────────────────────────────────────┘

1. 认证模块 → 所有模块
   - 提供用户身份认证信息
   - JWT Token验证

2. 项目管理模块 → 任务中心模块
   - 项目ID、项目名称
   - 功能模块ID

3. 项目管理模块 → 供应商模块
   - 项目ID
   - 项目供应商关联

4. 项目管理模块 → 数据分析模块
   - 项目进度数据
   - 里程碑状态
   - 风险数据

5. 任务中心模块 → 数据分析模块
   - 任务状态
   - 任务进度
   - 延期任务数据

6. 供应商模块 → 数据分析模块
   - 供应商进度
   - 付款数据

7. 项目管理模块 → 周日报模块
   - 项目概述数据
   - 功能模块完成情况
   - 风险数据

8. 任务中心模块 → 周日报模块
   - 任务完成情况
   - 进度更新记录

9. 系统管理模块 → 项目管理模块
   - 里程碑模板
   - 系统配置项

10. 系统管理模块 → 周日报模块
    - 报告模板
    - AI配置
```

### 核心数据实体关系

```
users (1) ──────< (N) project_members >────── (N) projects
                     │
                     ├──< (N) project_modules
                     ├──< (N) project_milestones >──< (N) milestone_tasks
                     ├──< (N) tasks >──< (N) task_assignees
                     ├──< (N) suppliers
                     ├──< (N) risks
                     └──< (N) reports

milestone_templates (1) ───< (N) milestone_tasks (模板)
ai_providers (1) ───< (N) ai_roles
report_templates (1) ───< (N) reports
```

---

## 五、验收标准

### 整体系统验收标准

1. **功能完整性**：所有8个模块的核心功能正常运行
2. **数据一致性**：跨模块数据流转准确无误
3. **权限控制**：角色权限严格按需求文档执行
4. **性能要求**：
   - 页面加载时间 < 3秒
   - 数据查询响应 < 2秒
   - 报表生成 < 10秒
5. **兼容性**：支持Chrome、Firefox、Edge最新版本

### 各模块独立验收标准

| 模块 | 关键验收指标 |
|------|-------------|
| 认证模块 | 登录成功率 > 99%，Token刷新无感知 |
| 工作台模块 | 统计数据准确性100%，加载时间 < 3秒 |
| 项目管理模块 | 功能模块支持10级嵌套，Excel导入成功率 > 95% |
| 任务中心模块 | 批量操作支持100个任务，状态变更实时同步 |
| 供应商模块 | 供应商数据与项目可见性一致 |
| 数据分析模块 | 图表渲染 < 5秒，数据导出正常 |
| 周日报模块 | AI分析响应 < 10秒，公文格式导出正确 |
| 系统管理模块 | 配置变更实时生效，操作日志完整 |

---

## 六、交付物清单

1. **模块划分说明文档**（本文档）
2. **各模块独立需求文档**（8份）：
   - module-01-auth-requirements.md
   - module-02-dashboard-requirements.md
   - module-03-project-requirements.md
   - module-04-task-requirements.md
   - module-05-supplier-requirements.md
   - module-06-analytics-requirements.md
   - module-07-report-requirements.md
   - module-08-admin-requirements.md
3. **模块间接口定义文档**
4. **数据库设计文档**
5. **权限矩阵文档**

请确认此模块划分方案后，我将开始生成各模块的独立需求文档。