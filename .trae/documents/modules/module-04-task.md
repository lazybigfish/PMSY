# 模块04：任务中心模块需求文档

## 版本信息
- **版本**: 3.0
- **更新日期**: 2026-02-11
- **状态**: 待审查

---

## 一、模块概述

### 1.1 模块定位
任务中心模块负责任务的创建、分配、状态管理和进度跟踪，支持多处理人、高级搜索、批量操作和看板视图，是项目执行的核心协作工具。

### 1.2 核心职责
- 任务创建与分配
- 任务状态管理
- 责任人与处理人权限分离
- 高级搜索功能
- 批量操作
- 看板视图

---

## 二、用户角色与权限

### 2.1 角色定义

| 角色 | 说明 | 权限范围 |
|------|------|----------|
| **任务责任人** | 任务的创建者，拥有任务的最高权限 | 可编辑任务所有属性、添加/移除处理人、删除任务 |
| **任务处理人** | 被责任人分配参与任务执行的用户 | 只能更新任务状态、添加评论，不能修改任务属性 |
| 项目经理 | 项目的管理者 | 可管理项目内所有任务 |
| 系统管理员 | 系统管理员 | 可管理所有任务 |

### 2.2 权限矩阵

| 功能 | 任务责任人 | 任务处理人 | 项目经理 | 系统管理员 |
|------|-----------|-----------|----------|-----------|
| 创建任务 | ✓ | ✓ | ✓ | ✓ |
| **编辑任务属性** | **✓** | **✗** | ✓(项目内) | ✓ |
| **添加/移除处理人** | **✓** | **✗** | ✓(项目内) | ✓ |
| **修改关联模块** | **✓** | **✗** | ✓(项目内) | ✓ |
| **修改截止日期** | **✓** | **✗** | ✓(项目内) | ✓ |
| **修改优先级** | **✓** | **✗** | ✓(项目内) | ✓ |
| 更新状态 | ✓ | ✓ | ✓ | ✓ |
| 添加评论 | ✓ | ✓ | ✓ | ✓ |
| 删除任务 | ✓ | ✗ | ✓(项目内) | ✓ |
| 批量操作 | ✓ | ✗ | ✓ | ✓ |
| 查看任务 | ✓ | ✓ | ✓ | ✓ |

**关键区别：**
- **责任人**：任务创建者，拥有任务的完全控制权
- **处理人**：只能更新任务状态和添加评论，不能修改任务的任何属性

---

## 三、功能需求

### 3.1 任务列表页面

#### 3.1.1 页面头部
- **标题**: "任务中心"
- **副标题**: "管理项目任务，跟踪执行进度"
- **新建任务按钮**: 打开创建任务弹窗

#### 3.1.2 视图切换
| 视图 | 说明 |
|------|------|
| 列表视图 | 表格形式展示任务详情 |
| 看板视图 | 按状态分栏展示任务卡片 |

#### 3.1.3 搜索与筛选
| 功能 | 说明 |
|------|------|
| 基础搜索 | 按任务标题搜索 |
| 筛选条件 | 全部/我的任务/待处理/已完成/公开任务 |
| 项目筛选 | 按关联项目筛选 |
| 高级搜索 | 多条件组合搜索 |
| 排序 | 创建时间/截止日期/优先级/完成时间/创建人 |

#### 3.1.4 高级搜索
支持多条件组合搜索：
- 字段选择：标题、状态、优先级、项目等
- 操作符：等于、不等于、包含、大于、小于等
- 值输入：根据字段类型输入对应值
- 条件组合：支持AND/OR逻辑

#### 3.1.5 任务列表表格

| 列名 | 说明 |
|------|------|
| 选择框 | 批量选择任务 |
| 任务标题 | 任务名称，点击可查看详情 |
| 所属项目 | 关联项目名称 |
| **责任人** | **显示任务责任人（创建者）** |
| 处理人 | 显示所有处理人头像，第一个为主要负责人 |
| 状态 | 未开始/进行中/已完成/已暂停/已取消 |
| 优先级 | 高/中/低，带颜色标识 |
| 截止日期 | 任务截止日期 |
| 操作 | 编辑、删除、状态变更 |

**注意**：任务列表的"负责人"字段显示的是**责任人**（任务创建者），而非处理人。

**状态颜色标识:**
| 状态 | 颜色 |
|------|------|
| 未开始 | 灰色 |
| 进行中 | 蓝色 |
| 已完成 | 绿色 |
| 已暂停 | 黄色 |
| 已取消 | 红色 |

**优先级颜色标识:**
| 优先级 | 颜色 |
|--------|------|
| 高 | 红色 |
| 中 | 黄色 |
| 低 | 蓝色 |

#### 3.1.6 批量操作
选中多个任务后可进行批量操作：
- 批量变更状态
- 批量删除

#### 3.1.7 看板视图
按状态分栏展示任务卡片：
- 每列显示一个状态的任务
- 任务卡片显示：标题、项目、责任人、处理人、优先级、截止日期
- 支持拖拽变更状态（如实现）

### 3.2 任务创建

#### 3.2.1 创建弹窗
点击"新建任务"打开创建弹窗：

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| 任务标题 | 文本 | 是 | 任务名称 |
| 任务描述 | 文本域 | 否 | 任务详细描述 |
| 关联项目 | 下拉选择 | 是 | 选择所属项目 |
| 关联模块 | 下拉选择 | 否 | 选择项目功能模块（联动） |
| 优先级 | 单选 | 是 | 高/中/低 |
| 截止日期 | 日期选择 | 否 | 任务截止日期 |
| **责任人** | **自动** | **是** | **默认为当前登录用户（创建者）** |
| 处理人 | 多选 | 否 | 选择多个处理人（责任人可添加） |
| 是否公开 | 开关 | 否 | 任务是否对团队成员可见 |

#### 3.2.2 联动逻辑
- 选择项目后，关联模块下拉框加载该项目的功能模块
- 第一个选择的处理人设为主要负责人（is_primary=true）
- **责任人自动设为当前登录用户（创建者）**

#### 3.2.3 创建流程
1. 填写任务信息
2. 点击"创建任务"
3. 系统创建任务记录，设置责任人为当前用户
4. 添加任务处理人（如选择了）
5. 关闭弹窗，刷新列表
6. 可选：跳转到任务详情页

### 3.3 任务状态管理

#### 3.3.1 状态定义
| 状态 | 标识 | 说明 |
|------|------|------|
| 未开始 | todo | 任务已创建但未开始执行 |
| 进行中 | in_progress | 任务正在执行中 |
| 已完成 | done | 任务已完成 |
| 已暂停 | paused | 任务暂时暂停 |
| 已取消 | canceled | 任务已取消 |

#### 3.3.2 状态变更
- **责任人**：可以变更任意状态
- **处理人**：只能更新任务状态，不能修改其他属性
- 变更为"已完成"时自动记录完成时间
- 从"已完成"变更为其他状态时清空完成时间
- 状态变更后通知所有处理人（除操作者外）

### 3.4 任务进度更新

#### 3.4.1 功能概述
任务处理人可以在任务执行过程中提交进度更新，记录工作进展和成果。

#### 3.4.2 进度更新表单

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| 进度百分比 | 下拉选择 | 是 | 0% / 25% / 50% / 75% / 100% |
| 更新内容 | 文本域 | 是 | 进度描述、工作内容说明 |
| 成果附件 | 文件上传 | 否 | 支持上传多个文件（文档、图片等） |

#### 3.4.3 进度更新流程
1. 处理人点击"更新进度"按钮
2. 填写进度百分比、更新内容
3. 可选：上传成果附件
4. 点击"提交更新"
5. 系统保存进度记录
6. 在历史记录中显示该更新
7. 通知责任人和其他处理人

#### 3.4.4 进度更新规则
- 只有**处理人**和**责任人**可以提交进度更新
- 进度百分比为 100% 时，自动将任务状态变更为"已完成"
- 每个进度更新都会生成一条历史记录
- 附件上传后存储到文件系统，记录文件URL

#### 3.4.5 历史记录展示
历史记录列表显示所有进度更新，每条记录包含：
- 更新人头像和姓名
- 更新时间
- 进度百分比（带进度条可视化）
- 更新内容文本
- 附件列表（可下载）

### 3.4 任务详情页面

#### 3.4.1 页面内容
- 任务标题和描述
- **责任人信息**（显示创建者）
- 关联项目和模块
- 处理人列表（责任人可添加/移除）
- 状态和时间线
- 优先级
- 截止日期
- 创建人和创建时间

#### 3.4.2 权限控制

**责任人视角：**
- 可编辑所有任务属性
- 可添加/移除处理人
- 可修改关联模块
- 可修改截止日期
- 可修改优先级
- 可删除任务

**处理人视角：**
- 只能查看任务信息
- 只能更新任务状态
- 只能添加评论
- **不能修改任何任务属性**
- **不能添加/移除其他处理人**

---

## 四、数据模型

### 4.1 核心数据表

#### tasks（任务表）
| 字段 | 类型 | 说明 |
|------|------|------|
| id | uuid | 主键 |
| project_id | uuid | 项目ID |
| module_id | uuid | 模块ID |
| title | text | 任务标题 |
| description | text | 任务描述 |
| status | text | 状态：todo/in_progress/paused/done/canceled |
| priority | text | 优先级：low/medium/high |
| is_public | boolean | 是否公开 |
| due_date | timestamptz | 截止日期 |
| completed_at | timestamptz | 完成时间 |
| created_by | uuid | 创建人ID（即责任人） |
| owner_id | uuid | 负责人ID（同created_by） |
| created_at | timestamptz | 创建时间 |

**说明**：
- `created_by` 字段即为**责任人**
- `owner_id` 字段保留，与 `created_by` 保持一致

#### task_assignees（任务处理人表）
| 字段 | 类型 | 说明 |
|------|------|------|
| id | uuid | 主键 |
| task_id | uuid | 任务ID |
| user_id | uuid | 用户ID（处理人） |
| is_primary | boolean | 是否主要负责人 |
| assigned_at | timestamptz | 分配时间 |

**说明**：
- 责任人通过此表添加**处理人**
- 一个任务可以有多个处理人
- 第一个添加的处理人设为 `is_primary=true`

#### task_progress_updates（任务进度更新表）
| 字段 | 类型 | 说明 |
|------|------|------|
| id | uuid | 主键 |
| task_id | uuid | 任务ID |
| progress | integer | 进度百分比（0-100） |
| content | text | 更新内容描述 |
| created_by | uuid | 更新人ID |
| created_at | timestamptz | 更新时间 |

#### task_progress_attachments（进度附件表）
| 字段 | 类型 | 说明 |
|------|------|------|
| id | uuid | 主键 |
| progress_update_id | uuid | 进度更新记录ID |
| file_name | text | 文件名 |
| file_url | text | 文件URL |
| file_type | text | 文件类型 |
| file_size | integer | 文件大小（字节） |
| created_at | timestamptz | 上传时间 |

### 4.2 TypeScript类型定义

```typescript
interface Task {
  id: string;
  project_id: string;
  module_id?: string;
  title: string;
  description: string;
  status: 'todo' | 'in_progress' | 'paused' | 'done' | 'canceled';
  priority: 'low' | 'medium' | 'high';
  is_public: boolean;
  due_date?: string;
  completed_at?: string;
  created_by: string;  // 责任人（创建者）
  owner_id: string;    // 负责人（同created_by）
  created_at: string;
}

interface TaskAssignee {
  id: string;
  task_id: string;
  user_id: string;
  is_primary: boolean;
  assigned_at: string;
}

interface TaskWithDetails extends Task {
  project?: Project;
  creator?: Profile;        // 责任人信息
  assignees?: { user_id: string; is_primary: boolean; user: Profile }[];  // 处理人列表
  assignee_profiles?: Profile[];
}

interface TaskProgressUpdate {
  id: string;
  task_id: string;
  progress: number;         // 进度百分比 0-100
  content: string;          // 更新内容
  created_by: string;       // 更新人ID
  created_at: string;       // 更新时间
  creator?: Profile;        // 更新人信息
  attachments?: TaskProgressAttachment[];  // 附件列表
}

interface TaskProgressAttachment {
  id: string;
  progress_update_id: string;
  file_name: string;
  file_url: string;
  file_type: string;
  file_size: number;
  created_at: string;
}
```

---

## 五、接口规范

### 5.1 获取任务列表

```typescript
// 获取任务列表
let query = supabase
  .from('tasks')
  .select(`
    *,
    project:projects(id, name),
    creator:created_by(*)  // 责任人信息
  `)
  .order(sortBy, { ascending: sortOrder === 'asc' });

const { data: tasksData, error } = await query;

// 获取任务处理人
const { data: assigneesData } = await supabase
  .from('task_assignees')
  .select(`
    *,
    user:profiles(id, full_name, avatar_url, email)
  `)
  .in('task_id', taskIds);
```

### 5.2 创建任务

```typescript
// 创建任务
const { data: task, error } = await supabase
  .from('tasks')
  .insert({
    title,
    description,
    project_id,
    module_id,
    priority,
    is_public,
    due_date,
    created_by: user.id,  // 责任人（当前用户）
    owner_id: user.id,    // 负责人（同责任人）
    status: 'todo'
  })
  .select()
  .single();

// 添加处理人（责任人添加）
const assigneesToInsert = assignee_ids.map((userId, index) => ({
  task_id: task.id,
  user_id: userId,
  is_primary: index === 0
}));

await supabase.from('task_assignees').insert(assigneesToInsert);
```

### 5.3 提交进度更新

```typescript
// 1. 创建进度更新记录
const { data: progressUpdate, error } = await supabase
  .from('task_progress_updates')
  .insert({
    task_id: taskId,
    progress: progressPercent,  // 0, 25, 50, 75, 100
    content: updateContent,
    created_by: user.id
  })
  .select()
  .single();

if (error) throw error;

// 2. 保存附件记录（如果有）
if (attachments.length > 0) {
  const attachmentsToInsert = attachments.map(file => ({
    progress_update_id: progressUpdate.id,
    file_name: file.name,
    file_url: file.url,
    file_type: file.type,
    file_size: file.size
  }));
  
  await supabase
    .from('task_progress_attachments')
    .insert(attachmentsToInsert);
}

// 3. 如果进度为100%，自动完成任务
if (progressPercent === 100) {
  await supabase
    .from('tasks')
    .update({
      status: 'done',
      completed_at: new Date().toISOString()
    })
    .eq('id', taskId);
}

// 4. 发送通知给责任人和其他处理人
const notifications = [
  // 通知责任人
  {
    user_id: task.created_by,
    title: '任务进度更新',
    content: `任务 "${task.title}" 进度更新为 ${progressPercent}%`,
    type: 'info',
    is_read: false
  },
  // 通知其他处理人
  ...task.assignees
    .filter(a => a.user_id !== user.id)
    .map(a => ({
      user_id: a.user_id,
      title: '任务进度更新',
      content: `任务 "${task.title}" 进度更新为 ${progressPercent}%`,
      type: 'info',
      is_read: false
    }))
];

await supabase.from('notifications').insert(notifications);
```

### 5.4 获取进度更新历史

```typescript
const { data: progressUpdates } = await supabase
  .from('task_progress_updates')
  .select(`
    *,
    creator:created_by(*),
    attachments:task_progress_attachments(*)
  `)
  .eq('task_id', taskId)
  .order('created_at', { ascending: false });
```

### 5.5 更新任务状态

```typescript
const updates: any = { status: newStatus };

if (newStatus === 'done') {
  updates.completed_at = new Date().toISOString();
} else {
  updates.completed_at = null;
}

const { error } = await supabase
  .from('tasks')
  .update(updates)
  .eq('id', taskId);

// 发送通知
const notifications = task.assignees
  .filter(a => a.user_id !== user.id)
  .map(a => ({
    user_id: a.user_id,
    title: 'Task Status Updated',
    content: `Task "${task.title}" status changed to ${newStatus}`,
    type: 'info',
    is_read: false
  }));

await supabase.from('notifications').insert(notifications);
```

### 5.4 权限检查逻辑

```typescript
// 检查是否为责任人
const isOwner = user?.id === task?.created_by;

// 检查是否为处理人
const isAssignee = task?.assignees?.some(a => a.user_id === user?.id);

// 检查是否有编辑权限（只有责任人可以编辑）
const canEdit = isOwner;

// 检查是否可以更新状态（责任人或处理人都可以）
const canUpdateStatus = isOwner || isAssignee;
```

---

## 六、界面原型

### 6.1 任务列表（列表视图）

```
┌─────────────────────────────────────────────────────────────────────┐
│ 任务中心                                            [+ 新建任务]      │
│ 管理项目任务，跟踪执行进度                                           │
├─────────────────────────────────────────────────────────────────────┤
│ [列表] [看板]  [搜索任务...] [全部 ▼] [项目 ▼] [高级搜索] [排序 ▼]    │
├─────────────────────────────────────────────────────────────────────┤
│ ☐ │ 任务标题      │ 项目     │ 责任人 │ 处理人 │ 状态   │ 优先级 │ 截止日期 │
├───┼───────────────┼──────────┼────────┼────────┼────────┼────────┼──────────┤
│ ☐ │ 完成需求分析   │ 项目A    │ 👤张三 │ 👤👤   │ 进行中 │ 高     │ 02-15   │
│ ☐ │ 编写测试用例   │ 项目B    │ 👤李四 │ 👤     │ 未开始 │ 中     │ 02-20   │
│ ☐ │ 修复登录bug   │ 项目A    │ 👤张三 │ 👤👤👤 │ 已完成 │ 高     │ 02-10   │
└───┴───────────────┴──────────┴────────┴────────┴────────┴────────┴──────────┘
```

**注意**：列表中新增"责任人"列，显示任务创建者。

### 6.2 任务详情页（责任人视角）

```
┌─────────────────────────────────────────┐
│ ← 完成需求分析                    [编辑] │
├─────────────────────────────────────────┤
│ [详情] [评论] [历史]                    │
├─────────────────────────────────────────┤
│                                         │
│ 状态: [进行中 ▼]    优先级: [高]        │
│                                         │
│ 责任人: 👤 张三                         │
│                                         │
│ 处理人: 👤 李四 (主)  👤 王五  [+ 添加] │
│                                         │
│ 所属项目: 项目A                         │
│                                         │
│ 关联模块: [模块1] [模块2] [模块3] [变更] │
│                                         │
│ 截止日期: 2026-02-15                    │
│                                         │
│ 任务描述:                               │
│ 完成系统需求分析文档...                  │
│                                         │
└─────────────────────────────────────────┘
```

### 6.3 任务详情页（处理人视角）

```
┌─────────────────────────────────────────┐
│ ← 完成需求分析                          │
├─────────────────────────────────────────┤
│ [详情] [评论] [历史]                    │
├─────────────────────────────────────────┤
│                                         │
│ 状态: [进行中 ▼]    优先级: 高          │
│           ↑ 只能修改状态                │
│ 责任人: 👤 张三                         │
│                                         │
│ 处理人: 👤 李四 (主)  👤 王五           │
│                                         │
│ 所属项目: 项目A                         │
│                                         │
│ 关联模块: [模块1] [模块2]               │
│                                         │
│ 截止日期: 2026-02-15                    │
│                                         │
│ 任务描述:                               │
│ 完成系统需求分析文档...                  │
│                                         │
└─────────────────────────────────────────┘
```

**注意**：处理人视角下，只能修改状态，其他字段均为只读。

### 6.4 任务详情页 - 进度更新弹窗

```
┌─────────────────────────────────────────┐
│ 更新进度                          [×]   │
├─────────────────────────────────────────┤
│                                         │
│ 当前进度: ████████░░ 80%                │
│                                         │
│ 更新进度 *                              │
│ ┌─────────────────────────────────────┐ │
│ │ [0% ▼]                              │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 更新内容 *                              │
│ ┌─────────────────────────────────────┐ │
│ │ 已完成前端页面开发，正在进行接口    │ │
│ │ 联调测试...                         │ │
│ │                                     │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 成果附件                                │
│ ┌─────────────────────────────────────┐ │
│ │ [📎 点击上传或拖拽文件到此处]       │ │
│ │                                     │ │
│ │ 已上传:                             │ │
│ │ 📄 设计稿_v1.pdf (2.3MB)      [×]   │ │
│ │ 📄 接口文档.docx (1.1MB)      [×]   │ │
│ └─────────────────────────────────────┘ │
│                                         │
│        [取消]      [提交更新]           │
│                                         │
└─────────────────────────────────────────┘
```

### 6.5 任务详情页 - 历史记录（含进度更新）

```
┌─────────────────────────────────────────┐
│ ← 完成需求分析                          │
├─────────────────────────────────────────┤
│ [详情] [评论] [历史]                    │
├─────────────────────────────────────────┤
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │ 👤 李四                    2小时前 │ │
│ │                                     │ │
│ │ 📊 进度更新: 50% → 75%              │ │
│ │                                     │ │
│ │ 已完成数据库设计，正在进行API开发   │ │
│ │                                     │ │
│ │ 📎 附件:                            │ │
│ │ • 数据库设计文档.pdf                │ │
│ │ • API接口定义.xlsx                  │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │ 👤 张三                    1天前   │ │
│ │                                     │ │
│ │ 📝 状态变更: 待办 → 进行中          │ │
│ │                                     │ │
│ │ 任务已开始执行                      │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ ┌─────────────────────────────────────┐ │
│ │ 👤 李四                    2天前   │ │
│ │                                     │ │
│ │ 📊 进度更新: 0% → 25%               │ │
│ │                                     │ │
│ │ 已完成需求分析，开始设计阶段        │ │
│ │                                     │ │
│ │ 📎 附件:                            │ │
│ │ • 需求分析文档.docx                 │ │
│ └─────────────────────────────────────┘ │
│                                         │
└─────────────────────────────────────────┘
```

---

## 七、验收标准

### 7.1 功能验收

| 验收项 | 验收标准 | 状态 |
|--------|----------|------|
| 任务列表 | 支持列表/看板两种视图，显示责任人列 | 已实现 |
| 责任人与处理人 | 明确区分两个角色，权限分离 | 已实现 |
| 权限控制 | 责任人可编辑所有属性，处理人只能更新状态 | 已实现 |
| 任务创建 | 责任人自动设为创建者 | 已实现 |
| 状态管理 | 5种状态，责任人和处理人都可以更新 | 已实现 |
| **进度更新** | **支持进度百分比、内容描述、附件上传** | **待实现** |
| **历史记录** | **显示进度更新历史，含进度条可视化** | **待实现** |
| 高级搜索 | 支持多条件组合搜索 | 已实现 |
| 批量操作 | 支持批量状态变更和删除 | 已实现 |

### 7.2 权限验收

| 验收项 | 责任人 | 处理人 | 状态 |
|--------|--------|--------|------|
| 编辑任务属性 | ✓ | ✗ | 待实现 |
| 添加/移除处理人 | ✓ | ✗ | 待实现 |
| 修改关联模块 | ✓ | ✗ | 待实现 |
| 修改截止日期 | ✓ | ✗ | 待实现 |
| 修改优先级 | ✓ | ✗ | 待实现 |
| 更新状态 | ✓ | ✓ | 已实现 |
| 添加评论 | ✓ | ✓ | 已实现 |
| **提交进度更新** | **✓** | **✓** | **待实现** |

---

## 八、修订记录

| 版本 | 日期 | 修订内容 | 修订人 |
|------|------|----------|--------|
| 1.0 | 2025-02-09 | 初始版本 | AI Assistant |
| 2.0 | 2026-02-10 | 同步代码实现，更新多处理人、高级搜索、批量操作、看板视图 | AI Assistant |
| **3.0** | **2026-02-11** | **重大更新：明确区分责任人和处理人概念，实现权限分离** | **AI Assistant** |
| **3.1** | **2026-02-11** | **新增：任务进度更新功能（进度百分比、内容、附件）** | **AI Assistant** |

---

## 九、待办事项

### 已完成的优化
- [x] 更新任务列表页，添加"责任人"列
- [x] 修改任务详情页权限控制逻辑
- [x] 更新任务创建逻辑，自动设置责任人
- [x] 修改 canEdit 判断逻辑（仅责任人可编辑）
- [x] 更新任务状态更新权限（责任人和处理人都可以）

### 待实现的进度更新功能
- [ ] 创建数据库表：`task_progress_updates`、`task_progress_attachments`
- [ ] 开发进度更新弹窗组件
- [ ] 实现文件上传功能
- [ ] 在历史记录中显示进度更新
- [ ] 实现进度条可视化
- [ ] 100%进度时自动完成任务
- [ ] 发送进度更新通知
